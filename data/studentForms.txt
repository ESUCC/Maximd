-- student_forms view
--
drop view student_forms;
CREATE VIEW student_forms
    AS 
 
	SELECT id_student, pdf_archived, version_number, CAST('001' as CHAR( 3 ) ) as form_no, formname(CAST('001' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_001 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_001 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('002' as CHAR( 3 ) ) as form_no, formname(CAST('002' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_002 as id, status, '' as title, date_mdt as date, page_status, id_case_mgr, CASE WHEN date_mdt IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_002  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('003' as CHAR( 3 ) ) as form_no, formname(CAST('003' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_003 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_003  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('004' as CHAR( 3 ) ) as form_no, formname(CAST('004' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_004 as id, status, '' as title, date_conference as date, page_status, id_case_mgr, CASE WHEN date_conference IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_004  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('005' as CHAR( 3 ) ) as form_no, formname(CAST('005' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_005 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_005  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('006' as CHAR( 3 ) ) as form_no, formname(CAST('006' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_006 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_006  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('007' as CHAR( 3 ) ) as form_no, formname(CAST('007' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_007 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_007  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('008' as CHAR( 3 ) ) as form_no, formname(CAST('008' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_008 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_008  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('009' as CHAR( 3 ) ) as form_no, formname(CAST('009' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_009 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_009  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('010' as CHAR( 3 ) ) as form_no, formname(CAST('010' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_010 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_010  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('011' as CHAR( 3 ) ) as form_no, formname(CAST('011' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_011 as id, status, '' as title, mdt_conf_date as date, page_status, id_case_mgr, CASE WHEN mdt_conf_date IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_011  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('012' as CHAR( 3 ) ) as form_no, formname(CAST('012' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_012 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_012  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('013' as CHAR( 3 ) ) as form_no, formname(CAST('013' as CHAR( 3 ) )) || ' (' || ifsptype || ')', timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_013 as id, status, '' as title, meeting_date as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_013 where id_form_013 in (select distinct ifsp_master_parent(id_form_013) as masterid from iep_form_013 where id_student = id_student) UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('014' as CHAR( 3 ) ) as form_no, formname(CAST('014' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_014 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_014  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('015' as CHAR( 3 ) ) as form_no, formname(CAST('015' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_015 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_015  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('016' as CHAR( 3 ) ) as form_no, formname(CAST('016' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_016 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_016  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('017' as CHAR( 3 ) ) as form_no, formname(CAST('017' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_017 as id, status, title as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_017  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('018' as CHAR( 3 ) ) as form_no, formname(CAST('018' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_018 as id, status, title as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_018  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('019' as CHAR( 3 ) ) as form_no, formname(CAST('019' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_019 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_019  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('020' as CHAR( 3 ) ) as form_no, formname(CAST('020' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_020 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_020  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('021' as CHAR( 3 ) ) as form_no, formname(CAST('021' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_021 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_021  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('022' as CHAR( 3 ) ) as form_no, formname(CAST('022' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_022 as id, status, '' as title, date_mdt as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_022  UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('023' as CHAR( 3 ) ) as form_no, formname(CAST('023' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_023 as id, status, '' as title, date_conference as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_023 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('024' as CHAR( 3 ) ) as form_no, formname(CAST('024' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_024 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_024 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('025' as CHAR( 3 ) ) as form_no, formname(CAST('025' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_025 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_025 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('026' as CHAR( 3 ) ) as form_no, formname(CAST('026' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_026 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_026 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('027' as CHAR( 3 ) ) as form_no, formname(CAST('027' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_027 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_027 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('028' as CHAR( 3 ) ) as form_no, formname(CAST('028' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_028 as id, status, '' as title, today_date as date, page_status, id_case_mgr, CASE WHEN today_date IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_028 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('029' as CHAR( 3 ) ) as form_no, formname(CAST('029' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_029 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_029 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('030' as CHAR( 3 ) ) as form_no, formname(CAST('030' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_030 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_030 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('031' as CHAR( 3 ) ) as form_no, formname(CAST('031' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_031 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_031 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('032' as CHAR( 3 ) ) as form_no, formname(CAST('032' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_032 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_032 UNION ALL
	SELECT id_student, pdf_archived, version_number, CAST('033' as CHAR( 3 ) ) as form_no, formname(CAST('033' as CHAR( 3 ) )), timestamp_created,  to_char(timestamp_created,'MM/DD/YYYY') as create_date, id_form_033 as id, status, '' as title, date_notice as date, page_status, id_case_mgr, CASE WHEN date_notice IS NULL THEN 0 ELSE 1 END AS date_null FROM iep_form_033
	;
;

select * from student_forms where id_student ='1198891';



